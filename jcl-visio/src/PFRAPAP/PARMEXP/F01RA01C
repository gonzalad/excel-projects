    SELECT TDPRNFOY, TDPRNSOC, TDPRNCONT, TDPRNCARTE, TDPRNDT,                  
    TDCOCTIT, TDPRCPRODCOM, TDPRCPOSA, TDPRCPOSP, TDPRMSREC,                    
    TDPRMDECFIN, TDPRMCRD, TDPRMDECO, TDPRDECH1, TDPRBDUREE, TDPRCFREQ,         
    TDPRMMENS, TDPRTDEG, TDPRBPRESCA, TDPRCTITCBL, TDPRCPOLEACT,                
    TDPRCTYPEPROD, TDPRCCPTRAURO, TDPRBFINORIG, TDPRMFORIG, TDPRDCREAT,         
    TDPRNSOCAGRO, TDPRNAGRO, TDPRCVERROU, TDPRDVERROU, TDPRCIPHASE,             
    TDCOMDMA, TDCOTDEGMINI, TDCODAUGDMASETU, TDCODAUGDMAAETU,                   
    TDCODDMASETUB, TDCOMDMASETUB, TDCOCTYPCONTRAT, TDCOMDMS, TDCODCREAT,        
    TDOCCMOTIF, TDOCCDECITEL, TDOCCTYPEOUV, TDOCCTYPETUORI,                     
    TDOCCTYPEOCTSE, TDCPBREPORT, TDCPDLIMRECIDIV, TDCPCREFLEX,                  
    TDCPCTRSFREFLEX, TDCPCPHASES, TDCPCPHASA, TDCPCSSR, TDCPBMONTSSR,           
    TDCPBMOISSSR, SUBSTR (DIGITS (0) , 1, 9) , SUBSTR (DIGITS (0) , 1,          
    5) , SUBSTR (DIGITS (0) , 1, 6) , SUBSTR (DIGITS (0) , 1, 6) ,              
    SUBSTR (DIGITS (0) , 1, 6) , SUBSTR (DIGITS (0) , 1, 6) , SUBSTR (          
    DIGITS (0) , 1, 2) , SUBSTR (DIGITS (0) , 1, 3) , SUBSTR (DIGITS (0)        
    , 1, 7) , SUBSTR (DIGITS (0) , 1, 7) , SUBSTR (DIGITS (0) , 1, 7) ,         
    SUBSTR (DIGITS (0) , 1, 1) , SUBSTR (DIGITS (0) , 1, 7) , SUBSTR (          
    DIGITS (0) , 1, 1) , SUBSTR (DIGITS (0) , 1, 7) , SUBSTR (DIGITS (0)        
    , 1, 1) , SUBSTR (DIGITS (0) , 1, 7) , SUBSTR (DIGITS (0) , 1, 1) ,         
    SUBSTR (DIGITS (0) , 1, 7) , SUBSTR (DIGITS (0) , 1, 3) ,                   
    TDPRCPRODBASE, TDCPDDERSSR, TDPRCDEVISE, TDCPDDFIN, TDOCDDECIOCT,           
    TDPRCAUGDMA, TDPRDDREG, TDPRDPOSA, TDPRNAGCRCVT, TDCODREFAUGDMA,            
    CHAR (VALUE (TBQRBOUVCPTE, ' ') ) , TDCPNREFPART, SUBSTR (DIGITS (          
    COALESCE (TDBACPD1, 0) ) , 7, 5) , SUBSTR (DIGITS (COALESCE (               
    TDBACEADREG, 0) ) , 7, 5) , SUBSTR (DIGITS (COALESCE (TDBACPERD, 0))        
    , 7, 5), TDC2CHISTORET,                                                     
    DECIMAL ((IFNULL (TDBAMUTICLI, 0)), 11, 2),                                 
    DECIMAL ((IFNULL (TDBAMAUTOCLI, 0)), 11, 2)                                 
    ,DECIMAL ((IFNULL (TDBACNOTEQUAENCBA, 0)), 7, 0)                            
    ,CHAR(COALESCE (TDBACCOTEQUAENCBA, ' '))                                    
    ,DATE (COALESCE (TDBADVALSCORENCBA, '0001-01-01') )                         
    ,CHAR(COALESCE (TDBACRATINGBALPD, ' '))                                     
    ,CHAR(COALESCE (TDBACRATINGBALLGD, ' ')),                                   
    DECIMAL((IFNULL (TDBAMEXPLOST,0)),11,2),                                    
    DECIMAL((IFNULL(TDBAMUNLOST,0)),11,2)                                       
    FROM PFRA.TBDOCPL, PFRA.TBDOOCT, PFRA.TBDOCTR, PFRA.TBDOCP2,                
         PFRA.TBDOPRN LEFT                                                      
    OUTER JOIN PFRA.TBBQRIB ON TDPRNFOY = TBQRNFOY AND TDPRCBQ =                
    TBQRNRANG LEFT OUTER JOIN PFRA.TBDOBAL ON TDBANFOY = TDPRNFOY AND           
    TDBANCONT = TDPRNCONT AND TDBANCARTE = TDPRNCARTE AND TDBANDT =             
    TDPRNDT                                                                     
    WHERE TDPRNFOY BETWEEN 04337170000 AND 99999999999 AND TDCPNFOY             
    BETWEEN 04337170000 AND 99999999999 AND TDCONFOY BETWEEN 04337170000        
    AND 99999999999 AND TDOCNFOY BETWEEN 04337170000 AND 99999999999 AND        
    TDPRNFOY = TDCPNFOY AND TDPRNCONT = TDCPNCONT AND TDPRNCARTE =              
    TDCPNCARTE AND TDPRNDT = TDCPNDT AND TDPRNFOY = TDCONFOY AND                
    TDPRNCONT = TDCONCONT AND TDPRNCARTE = TDCONCARTE AND TDPRNDT =             
    TDCONDT AND TDPRNFOY = TDOCNFOY AND TDPRNCONT = TDOCNCONT AND               
    TDPRNCARTE = TDOCNCARTE AND TDPRNDT = TDOCNDT AND TDOCNRANG = 1             
    AND TDPRNFOY = TDC2NFOY AND TDPRNCONT = TDC2NCONT AND                       
    TDPRNCARTE = TDC2NCARTE AND TDPRNDT = TDC2NDT;                              


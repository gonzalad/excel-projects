    SELECT TDPRNFOY           ,                                                 
           TDPRNCONT          ,                                                 
           TDPRNCARTE         ,                                                 
           TDPRNDT            ,                                                 
           TDPRNSOC           ,                                                 
           TDPRDCREAT         ,                                                 
           TDPRDMOD           ,                                                 
           TDPRCINACT         ,                                                 
           TDPRDINACT         ,                                                 
           TDPRCPOSA          ,                                                 
           TDPRDPOSA          ,                                                 
           TDPRCPOSP          ,                                                 
           TDPRDPOSP          ,                                                 
           TDPRCPRODCOM       ,                                                 
           TDPRCPROFPROD      ,                                                 
           TDPRCGCOMPT        ,                                                 
           TDPRCPRODVDR       ,                                                 
           TDPRNSOCCOMMU      ,                                                 
           TDPRCTYPEPROD      ,                                                 
           TDPRCPRODBASE      ,                                                 
           TDPRCCPTRAURO      ,                                                 
           TDPRDTITRI         ,                                                 
           TDPRNLOTTITRI      ,                                                 
           TDPRNCC            ,                                                 
           TDPRNSOCSEP        ,                                                 
           TDPRNSOCFIN        ,                                                 
           TDPRNSOCGEO        ,                                                 
           TDPRNSOCAGRO       ,                                                 
           TDPRNAGRO          ,                                                 
           TDPRNSOCAGR        ,                                                 
           TDPRNAGR           ,                                                 
           TDPRCPORTF         ,                                                 
           TDPRCBAREME        ,                                                 
           TDPRTBAREME        ,                                                 
           TDPRTNC            ,                                                 
           TDPRTCOEFRES       ,                                                 
           TDPRTVDR           ,                                                 
           TDPRCBARSPEC       ,                                                 
           TDPRTBARSPEC       ,                                                 
           TDPRDFINBARSPEC    ,                                                 
           TDPRBMENS          ,                                                 
           TDPRDECH1          ,                                                 
           TDPRCFREQ          ,                                                 
           TDPRNQUANT         ,                                                 
           TDPRNCHQUANT       ,                                                 
           TDPRBDUREE         ,                                                 
           TDPRBDURREST       ,                                                 
           TDPRTDEG           ,                                                 
           TDPRCTOPDOUBRES    ,                                                 
           TDPRCCHR           ,                                                 
           TDPRBITERCYCLE     ,                                                 
           TDPRCMMMULTI       ,                                                 
           TDPRCECHEL         ,                                                 
           TDPRCDURMENS       ,                                                 
           TDPRCAGIOSDIF      ,                                                 
           TDPRCPRESKUNI      ,                                                 
           TDPRTRETROAGIOS    ,                                                 
           TDPRCAGIOSFP       ,                                                 
           TDPRCQUEST         ,                                                 
           TDPRCOPT           ,                                                 
           TDPRCBARASS        ,                                                 
           TDPRDVBARASS       ,                                                 
           TDPRCPAIFASS       ,                                                 
           TDPRCOPTCO         ,                                                 
           TDPRCBARASSCO      ,                                                 
           TDPRDVBARASSCO     ,                                                 
           TDPRCPAIFASSCO     ,                                                 
           TDPRMDECO          ,                                                 
           TDPRMDECFIN        ,                                                 
           TDPRMVARDEC        ,                                                 
           TDPRDAUGCRU        ,                                                 
           TDPRMAGIOVDR       ,                                                 
           TDPRMAGIOCLT       ,                                                 
           TDPRMTOTASS        ,                                                 
           TDPRMVARAGIOS      ,                                                 
           TDPRMVARASS        ,                                                 
           TDPRDAVANCEVDR     ,                                                 
           TDPRCAVANCEVDR     ,                                                 
           TDPRMAVANCEVDR     ,                                                 
           TDPRCPOLEACT       ,                                                 
           TDPRCDEVISE        ,                                                 
           TDPRMCAUTION       ,                                                 
           TDPRNFONDCAUT      ,                                                 
           TDPRDAPOMAXI       ,                                                 
           TDPRCFORPO         ,                                                 
           TDPRCPAIEMENT      ,                                                 
           TDPRCBQ            ,                                                 
           TDPRCEXPED         ,                                                 
           TDPRCTITCAR        ,                                                 
           TDPRCCOMANDCA1     ,                                                 
           TDPRCCOMANDCA2     ,                                                 
           TDPRCFAUTO         ,                                                 
           TDPRBPRESCA        ,                                                 
           TDPRMAUTOCA        ,                                                 
           TDPRMAUTOCB        ,                                                 
           TDPRCPROFCB        ,                                                 
           TDPRBPTCADO        ,                                                 
           TDPRDDEBFIDEL      ,                                                 
           TDPRNOPERFIDEL     ,                                                 
           TDPRCCHEQ          ,                                                 
           TDPRDOUVCHEQ       ,                                                 
           TDPRMCUMASS        ,                                                 
           TDPRCASS           ,                                                 
           TDPRNAGCFIN        ,                                                 
           TDPRNAGCAPV        ,                                                 
           TDPRCAPVP          ,                                                 
           TDPRNAGCRCVT       ,                                                 
           TDPRCRCVTP         ,                                                 
           TDPRCRCVTB         ,                                                 
           TDPRL2LETNOM       ,                                                 
           TDPRCPTT           ,                                                 
           TDPRCPART1         ,                                                 
           TDPRCPART2         ,                                                 
           TDPRCPART3         ,                                                 
           TDPRCPART4         ,                                                 
           TDPRCPART5         ,                                                 
           TDPRCTIMBRAGE      ,                                                 
           TDPRCAUGDMA        ,                                                 
           TDPRCCHGTMENS      ,                                                 
           TDPRCMSO           ,                                                 
           TDPRDMSO           ,                                                 
           TDPRCPRESFINCT     ,                                                 
           TDPRDPROFINCT      ,                                                 
           TDPRDPAIFD         ,                                                 
           TDPRBRGEAT         ,                                                 
           TDPRDEAT           ,                                                 
           TDPRDMMULT1        ,                                                 
           TDPRCMMULT1        ,                                                 
           TDPRBJOKERACONS    ,                                                 
           TDPRDANNIOPS       ,                                                 
           TDPRDRENOUV        ,                                                 
           TDPRCNRENOUV       ,                                                 
           TDPRCVERROU        ,                                                 
           TDPRDVERROU        ,                                                 
           TDPRDCOTISCA       ,                                                 
           TDPRTSTAMPDEBP     ,                                                 
           TDPRTSTAMPDBIL     ,                                                 
           TDPRCFREQBIL       ,                                                 
           TDPRCGFREQBIL      ,                                                 
           TDPRCENVBIL        ,                                                 
           TDPRNQUANTBIL      ,                                                 
           TDPRCIPHASE        ,                                                 
           TDPRDECHP          ,                                                 
           TDPRDDPRE          ,                                                 
           TDPRMDPRE          ,                                                 
           TDPRMMENS          ,                                                 
           TDPRTEGM           ,                                                 
           TDPRMTODD          ,                                                 
           TDPRMAGREPORT      ,                                                 
           TDPRMAGIM          ,                                                 
           TDPRMAGFP          ,                                                 
           TDPRMAGACHATM1     ,                                                 
           TDPRMFINMAGM1      ,                                                 
           TDPRMACHATCHAINE   ,                                                 
           TDPRMACHATVDR      ,                                                 
           TDPRMCAPFP         ,                                                 
           TDPRMASSFP         ,                                                 
           TDPRMPCFP          ,                                                 
           TDPRMAGREPORTFP    ,                                                 
           TDPRMFDMOFP        ,                                                 
           TDPRMAGIOSFPFM     ,                                                 
           TDPRMCOTIFP        ,                                                 
           TDPRMFASS          ,                                                 
           TDPRTSURPRIMS      ,                                                 
           TDPRMFASSCO        ,                                                 
           TDPRTSURPRIMSC     ,                                                 
           TDPRMFORIG         ,                                                 
           TDPRBFINORIG       ,                                                 
           TDPRMAGAC          ,                                                 
           TDPRMASSREG        ,                                                 
           TDPRMPCDOM         ,                                                 
           TDPRMPCREGLE       ,                                                 
           TDPRMFREPORT       ,                                                 
           TDPRMIR            ,                                                 
           TDPRDDANNINDRET    ,                                                 
           TDPRMFRCHQUANT     ,                                                 
           TDPRMCDVERSE       ,                                                 
           TDPRMIANTI         ,                                                 
           TDPRMREGORIG       ,                                                 
           TDPRMFRDIVERS      ,                                                 
           TDPRMPP            ,                                                 
           TDPRDDPP           ,                                                 
           TDPRMPPAGC         ,                                                 
           TDPRCMOTPP         ,                                                 
           TDPRMREMORIG       ,                                                 
           TDPRMREMISE        ,                                                 
           TDPRMTME           ,                                                 
           TDPRMECONT         ,                                                 
           TDPRMAGIOVRES      ,                                                 
           TDPRMCRD           ,                                                 
           TDPRMSREC          ,                                                 
           TDPRMSRECCAP       ,                                                 
           TDPRMSRECASS       ,                                                 
           TDPRMSRECPCAV      ,                                                 
           TDPRMSRECREPORT    ,                                                 
           TDPRMSRECRET       ,                                                 
           TDPRMSRECAGIOS     ,                                                 
           TDPRMSRECCOTI      ,                                                 
           TDPRMSRECDIVERS    ,                                                 
           TDPRMCOTIS         ,                                                 
           TDPRMVC            ,                                                 
           TDPRCOPTFIN        ,                                                 
           TDPRC1FINFDMO      ,                                                 
           TDPRMFDMO          ,                                                 
           TDPRMFDMOPREC      ,                                                 
           TDPRMAGFIM         ,                                                 
           TDPRMTDDBIL        ,                                                 
           TDPRDSORTBIL       ,                                                 
           TDPRMFPERIOD       ,                                                 
           TDPRCRPEDAGO       ,                                                 
           TDPRCGRPEDAGO      ,                                                 
           TDPRCRPEDAGOI      ,                                                 
           TDPRCGRPEDAGOI     ,                                                 
           TDPRMREGM          ,                                                 
           TDPRDMAJMREGM      ,                                                 
           TDPRMDREG          ,                                                 
           TDPRDDREG          ,                                                 
           TDPRCGESREPORT     ,                                                 
           TDPRMREPORTE       ,                                                 
           TDPRMREPORTACONS   ,                                                 
           TDPRMFREPPRE       ,                                                 
           TDPRDDANNINDREP    ,                                                 
           TDPRDCHFICOBA      ,                                                 
           TDPRCCOMANDCBL     ,                                                 
           TDPRNBINDTS        ,                                                 
           TDPRNCARTPHY       ,                                                 
           TDPRDDCALASSU      ,                                                 
           TDPRDSCPTCREDIT    ,                                                 
           TDPRCFIDEL         ,                                                 
           TDPRMCRUANC        ,                                                 
           TDPRCTITCBL        ,                                                 
           TDPRCINFBXVDR      ,                                                 
           TDPRCADRESCOUR     ,                                                 
           TDPRCINTERVDR      ,                                                 
           TDPRCOPTCPT        ,                                                 
           TDPRDCHGTOPTCPT    ,                                                 
           TDPRTNCEURO        ,                                                 
           TDPRCOPTASS        ,                                                 
           TDPRMAGIOSORIG     ,                                                 
           TDPRDDJOK1         ,                                                 
           TDPRDDJOK2         ,                                                 
           TDPRDDJOK3         ,                                                 
           TDPRMFMRB1         ,                                                 
           TDPRDFINANCABLE    ,                                                 
           TDPRMASMORIG       ,                                                 
           TDPRDDJOK          ,                                                 
           TDPRNAPERITEURFP   ,                                                 
           TDPRNCONVFP        ,                                                 
           TDPRNCONVSTYPEFP   ,                                                 
           TDPRNAVENANTFP     ,                                                 
           TDPRNAVENANTMDTFP  ,                                                 
           TDPRMFASSFP        ,                                                 
           TDPRCOPTFP         ,                                                 
           TDPRMFASSCOFP      ,                                                 
           TDPRCOPTCOFP       ,                                                 
           TDPRCSUIVISORTIE   ,                                                 
           TDPRDDPREM1        ,                                                 
           TDPRMVARAGIOORIG   ,                                                 
           TDPRMFRETORIG      ,                                                 
           TDPRMVARASSORIG    ,                                                 
           TRDOPHASEA         ,                                                 
           TRDODPHASEA        ,                                                 
           TRDOPHASEP         ,                                                 
           TRDODPHASEP                                                          
     FROM       PFRA.TBDOPRN                                                    
     INNER JOIN PFRA.TBREDOS                                                    
         ON TDPRNFOY    = TRDONFOY                                              
         AND TDPRNCONT  = TRDONCONT                                             
         AND TDPRNCARTE = TRDONCARTE                                            
         AND TDPRNDT    = TRDONDT                                               
         AND TDPRNSOC   = TRDOSOC                                               
      ,( SELECT MAX(DATE(TFPATIMESTAMP)) AS MAX                                 
         FROM PFRA.TBFIPAR                                                      
         WHERE TFPACNOMFIC = 'CGPE'                                             
         AND TFPALPROG         = 'NEMEFFN' ) AS TABL                            
      WHERE                                                                     
      ( (   TRDODPHASEA   >= MAX                                                
          AND                                                                   
         ( (     CURRENT TIME >= '20.00.00'                                     
             AND CURRENT TIME <= '23.59.59'                                     
             AND TRDODPHASEA <= CURRENT DATE )                                  
           OR                                                                   
           (     CURRENT TIME >= '00.00.00'                                     
             AND CURRENT TIME <= '19.59.59'                                     
             AND TRDODPHASEA <= (CURRENT DATE - 1 DAYS) )                       
         ) )                                                                    
      OR                                                                        
        (   TDPRDDEBFIDEL >= MAX                                                
          AND                                                                   
         ( (     CURRENT TIME >= '20.00.00'                                     
             AND CURRENT TIME <= '23.59.59'                                     
             AND TDPRDDEBFIDEL <= CURRENT DATE )                                
           OR                                                                   
           (     CURRENT TIME >= '00.00.00'                                     
             AND CURRENT TIME <= '19.59.59'                                     
             AND TDPRDDEBFIDEL <= (CURRENT DATE - 1 DAYS) )                     
         ) )                                                                    
      )  AND                                                                    
          TDPRCPOSA    = 'RET'    AND                                           
          (TDPRNFOY BETWEEN 4302812420 AND 4337169999)    AND                   
          TDPRNOPERFIDEL    = 14    AND                                         
          TDPRNSOC IN (100 , 114, 700, 714, 192)                                
     ORDER BY    TDPRNFOY    ASC,                                               
         TDPRNCONT  ASC,                                                        
         TDPRNCARTE ASC,                                                        
         TDPRNDT    DESC,                                                       
         TDPRNSOC   ASC                                                         
     WITH UR ;                                                                  

